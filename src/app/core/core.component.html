<div style="visibility: hidden; position: absolute;"
[style.left]="menuPosition.x"
[style.top]="menuPosition.y"
[matMenuTriggerFor]="menu"
></div>

<svg class="desLineSVG">
    <line [attr.x1]=desLinePos.x1 [attr.y1]=desLinePos.y1 [attr.x2]=desLinePos.x2 [attr.y2]=desLinePos.y2 style="stroke:#DCDCDC;stroke-width:1" [attr.visibility]=designLineVis/>
</svg>


<div class="coreHitBox" cdkDragBoundary=".stageDisplay" fxLayout="row" cdkDrag (cdkDragEnded)="onDrop($event)"
    [ngStyle]="initialPos()"
>                                                                                                                                                               

    <!-- Core Menu BUTTON    [disabled]="willOpen === false"  -->
    <div  cdkDragHandle class="core-menu-handle"
    >   
        <button fxLayout="column"  class="core-menu-button"
            (mousedown)="onHoldStart()" (mouseup)="onHoldEnd($event)"
        >
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
        </button>
    </div>

    <!-- Core Menu  
    ::ng-deep .mat-menu-panel.hiddenMenu
  visibility: hidden
  oppasity: 0%

  [ngClass]="{'hiddenMenu': true}"
    -->

    <mat-menu #menu="matMenu" >
        <button mat-menu-item [matMenuTriggerFor]="actions" >
            <img src="assets\Icon\Actions_Icon.png" class="iconAct">
            <span class="iconText">Actions</span>
        </button>
        <button mat-menu-item [matMenuTriggerFor]="modifications">
            <img src="assets\Icon\Modifications_Icon.png" class="icon">
            <span class="iconText">Modifications</span>
        </button>
        <button mat-menu-item (click)="DesignButtonDyn()" cdkOverlayOrigin #trigger="cdkOverlayOrigin">
            <img src="assets\Icon\Design_Icon.png" class="icon">
            <span class="iconText">Design</span>
        </button>
    </mat-menu>

    <mat-menu #actions="matMenu">
        <button mat-menu-item>
            <img src="assets\Icon\Actions_Delete_Icon.png" class="iconAct">
            <span>Delete Core</span>
        </button>
        <button mat-menu-item>
            <img src="assets\Icon\Actions_Duplicate_Icon.png" class="icon">
            <span>Duplicate Core</span>
        </button>
        <button mat-menu-item>
            <img src="assets\Icon\Actions_Hyper_Icon.png" class="icon">
            <span>Hyperlink Core</span>
        </button>
        <button mat-menu-item>
            <img src="assets\Icon\Actions_Bonds_Icon.png" class="icon">
            <span>List of Bonds</span>
        </button>
    </mat-menu>
    <mat-menu #modifications="matMenu">
        <button mat-menu-item>
            <img src="assets\Icon\Mods_Add_Icon.png" class="icon">
            <span>Add Rune</span>
        </button>
        <button mat-menu-item>
            <img src="assets\Icon\Mods_List_Icon.png" class="icon">
            <span>List of Runes</span>
        </button>
    </mat-menu>

    <ng-template
        cdkConnectedOverlay
        [cdkConnectedOverlayOrigin]="trigger"
        [cdkConnectedOverlayOpen]="designIsOpen"
    >
        <div class="designMenu" cdkDrag (cdkDragEnded)="onDesignDrop($event)" fxLayout="column">
            <div cdkDragHandle matRipple (mouseup)="getMousePos($event)" class="designDragHandle">
                <span class="dot2"></span>
                <span class="dot2"></span>
                <span class="dot2"></span>
            </div>
            <mat-tab-group   mat-align-tabs="start" fxFlex  (focusChange)="closeDesign($event)">
                <mat-tab class="tabDes">
                    <ng-template mat-tab-label>
                        <img src="assets\Icon\Design_Frame.png" class="iconDesTab">
                        Frame
                    </ng-template>
                    <div fxLayout="row" class="desWin2">
                        <div class="desTools" fxLayout="column">
                            <div class="toolRow" fxLayout="row">
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Transform.png" class="iconT"> </button>
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Select.png" class="iconT"> </button>
                            </div>
                            <div class="toolRow" fxLayout="row">
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Spline.png" class="iconT"> </button>
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Blob.png" class="iconT"> </button>
                            </div>
                            <div class="toolRow">
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Shapes.png" class="iconT"> </button>
                            </div>
                            <div class="toolRow" fxLayout="row">
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Transparency.png" class="iconT"> </button>
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Colour.png" class="iconT"> </button>
                            </div>
                            <div class="toolRow" fxLayout="row">
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Thickness.png" class="iconT"> </button>
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_Emmitance.png" class="iconT"> </button>
                            </div>
                            <div class="toolRow">
                                <button mat-stroked-button fxFlex> <img src="assets\Icon\Design_Frame_AddFrameInst.png" class="iconT"> </button>
                            </div>
                        </div>
                        <div class="desDivs">
                            frame display
                        </div>
                    </div>
                </mat-tab>
            
                <mat-tab class="tabDes">
                    <ng-template mat-tab-label>
                        <img src="assets\Icon\Design_Glazing.png" class="iconDesTab">
                        Glazing
                    </ng-template>
                    <div fxLayout="row" class="desWin2">
                        <div class="desTools">
                            Tools go Here
                        </div>
                        <div class="desDivs">
                            frame display
                        </div>
                    </div>
                </mat-tab>
            
                <mat-tab class="tabDes">
                    <ng-template mat-tab-label>
                        <img src="assets\Icon\Design_Datum.png" class="iconDesTab">
                        Datum
                    </ng-template>
                    <div fxLayout="row" class="desWin2">
                        <div class="desTools">
                            Tools go Here
                        </div>
                        <div class="desDivs">
                            frame display
                        </div>
                    </div>
                </mat-tab>
                <mat-tab >
                    <ng-template mat-tab-label>
                        <mat-icon>close</mat-icon>
                    </ng-template>
                </mat-tab>
            </mat-tab-group>
        </div>
    </ng-template>


    <!-- Shell -->

    <div class="shell" >
        {{coreData.datumText}}
    </div>
  
</div>